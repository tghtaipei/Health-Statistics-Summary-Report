# 衛生統計報表 PDF 轉換工具

## 📦 專案檔案清單

```
專案目錄/
├── app.py                               # GUI 主程式
├── excel_to_pdf_with_bookmarks.py       # Excel 轉 PDF 核心引擎
├── toc_generator.py                     # 封面與目錄生成器
├── cover.png                            # 封面背景圖
├── additionalinfo.png                   # 補充說明圖
│
├── build_exe.spec                       # PyInstaller 配置檔
├── requirements.txt                     # Python 套件清單
└── README.md                            # 本檔案
```
## 📋 系統需求

### 開發環境
- Python 3.8+
- Windows 10/11
- Microsoft Excel

### 執行環境（EXE 版本）
- Windows 10/11
- Microsoft Excel

---

## 🎯 功能特色

✅ **自動化處理**
- 一鍵轉換多個 Excel 工作表

✅ **專業排版**
- 精美封面（含單位標誌）
- 自動生成目錄
- 頁碼編號
- PDF 書籤導航

✅ **智能識別**
- 自動抓取工作表標題
- 失敗工作表自動略過

✅ **友善介面**
- 圖形化操作
- 進度顯示
- 錯誤提示

---

## 🔧 技術架構

```
┌─────────────┐
│   app.py    │  ← tkinter GUI 介面
└──────┬──────┘
       │ 呼叫
       ↓
┌──────────────────────────────┐
│ excel_to_pdf_with_bookmarks  │  ← 核心轉換引擎
│  - 工作表匯出               │
│  - PDF 合併                 │
│  - 頁碼疊加                 │
│  - 書籤生成                 │
└──────┬───────────────────────┘
       │ 使用
       ↓
┌──────────────────┐
│ toc_generator    │  ← 封面與目錄
│  - 封面設計      │
│  - 目錄編排      │
│  - 日期邏輯      │
└──────────────────┘
```

---

## 📦 打包流程

```
原始碼 (Python)
       ↓
  PyInstaller
       ↓
獨立執行檔 (EXE)
       ↓
    分發給用戶
```

**優點：**
- 用戶無需安裝 Python
- 單一檔案，方便分享
- 雙擊即可使用

---

## ⚙️ 相依套件

| 套件 | 版本 | 用途 |
|------|------|------|
| pywin32 | ≥305 | 控制 Excel |
| pypdf | ≥3.17.0 | PDF 處理 |
| reportlab | ≥4.0.7 | PDF 生成 |
| pyinstaller | ≥6.3.0 | 打包工具 |

---

## 📝 程式碼結構

### app.py（主介面）
- GUI 視窗設計
- 檔案選擇邏輯
- 進度顯示
- 錯誤處理

### excel_to_pdf_with_bookmarks.py（轉換引擎）
- Excel COM 控制
- 工作表標題擷取
- PDF 合併與頁碼
- 書籤生成

### toc_generator.py（封面與目錄）
- 封面圖片處理
- 目錄自動排版
- 日期計算邏輯

---

## 🐛 已知問題

1. **Excel 必須安裝**
   - 程式使用 COM 介面，需依賴 Excel 軟體

2. **轉換速度**
   - 大量工作表（20+）需較長時間
   - 建議分批處理

3. **特殊字元**
   - 工作表名稱避免使用 `\ / : * ? " < > |`

4. **防毒軟體誤報** ⚠️
   - PyInstaller 打包的程式可能被誤判為惡意程式
   - 這是正常現象，並非程式本身有問題
   - 已加入 `--noupx` 參數降低誤報率

---

## 🔄 版本歷程

### v1.0（2024年12月）
- ✅ 初始版本
- ✅ GUI 介面
- ✅ 自動打包腳本
- ✅ 完整使用手冊

---

## 📞 聯絡資訊

**開發單位：** 臺北市政府衛生局  

---

## 📄 授權條款

僅供臺北市政府衛生局內部使用。

---

## 🎉 致謝

感謝所有參與開發與測試的同仁！
